(function () {
  "use strict";

  const config = {
    colors: {
      alpha: "#FF4A1C",
      beta: "#B5BBE8",
      gamma: "#D9D0C5",
    },
    defaultSoftening: 0.08,
    presetSoftening: 0.0,
    worldScaleFactor: 0.22,
    defaultMaxSubsteps: 400,
    presetMaxSubsteps: 2000,
    ejectedDistance: 12,
    defaultFixedTimeStep: 0.001,
    presetFixedTimeStep: 1e-4,
    defaultRelTolerance: 1e-6,
    presetRelTolerance: 1e-6,
    defaultAbsTolerance: 1e-8,
    presetAbsTolerance: 1e-8,
    defaultSpeedMax: 4,
    presetSpeedMax: 4,
    singularityEpsilon: 1e-18,
    rkMinStep: 1e-7,
    rkGrowLimit: 1.6,
    rkShrinkLimit: 0.5,
    maxTrailSegmentPx: 140,
    displayUnitScale: 10,
    defaultClockSeconds: 0,
    defaultPreset: "figure-eight",
    presets: {
      "figure-eight": {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -0.97000436, y: 0.24308753 },
          beta: { x: 0.97000436, y: -0.24308753 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.466203685, y: 0.43236573 },
          beta: { x: 0.466203685, y: 0.43236573 },
          gamma: { x: -0.93240737, y: -0.86473146 },
        },
        G: 1.0,
        speed: 1.0,
      },
      "lagrange-triangle": {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: 0.0, y: 1.154700538 },
          beta: { x: -1.0, y: -0.577350269 },
          gamma: { x: 1.0, y: -0.577350269 },
        },
        velocities: {
          alpha: { x: -0.707106781, y: 0.0 },
          beta: { x: 0.353553391, y: -0.612372436 },
          gamma: { x: 0.353553391, y: 0.612372436 },
        },
        G: 1.0,
        speed: 1.0,
      },
      "euler-collinear": {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 0.0, y: 0.0 },
          gamma: { x: 1.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.0, y: 1.118033989 },
          beta: { x: 0.0, y: 0.0 },
          gamma: { x: 0.0, y: -1.118033989 },
        },
        G: 1.0,
        speed: 1.0,
      },
      "butterfly-i": {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 1.0, y: 0.0 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.306892758965492, y: 0.125506782829762 },
          beta: { x: 0.306892758965492, y: 0.125506782829762 },
          gamma: { x: -0.613785517930984, y: -0.251013565659524 },
        },
        G: 1.0,
        speed: 1.0,
      },
      broucke: {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: 0.0132604844, y: 0.0 },
          beta: { x: 1.4157286016, y: 0.0 },
          gamma: { x: -1.4289890859, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.0, y: 1.054151921 },
          beta: { x: 0.0, y: -0.2101466639 },
          gamma: { x: 0.0, y: -0.8440052572 },
        },
        G: 1.0,
        speed: 1.0,
      },
      henon: {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: 0.4752073013, y: 0.0 },
          beta: { x: 1.2395152885, y: 0.0 },
          gamma: { x: -1.7147225898, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.0, y: 1.1801113507 },
          beta: { x: 0.0, y: -0.4523369153 },
          gamma: { x: 0.0, y: -0.7277744354 },
        },
        G: 1.0,
        speed: 1.0,
      },
      "moth-iii": {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 1.0, y: 0.0 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.383443534851074, y: 0.377363693237305 },
          beta: { x: 0.383443534851074, y: 0.377363693237305 },
          gamma: { x: -0.766887069702148, y: -0.75472738647461 },
        },
        G: 1.0,
        speed: 1.0,
      },
      goggles: {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 1.0, y: 0.0 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.0833000564575194, y: 0.127889282226563 },
          beta: { x: 0.0833000564575194, y: 0.127889282226563 },
          gamma: { x: -0.166600112915039, y: -0.255778564453126 },
        },
        G: 1.0,
        speed: 1.0,
      },
      dragonfly: {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 1.0, y: 0.0 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.080584285736084, y: 0.588836087036132 },
          beta: { x: 0.080584285736084, y: 0.588836087036132 },
          gamma: { x: -0.161168571472168, y: -1.177672174072264 },
        },
        G: 1.0,
        speed: 1.0,
      },
      yarn: {
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 1.0, y: 0.0 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: 0.559064247131347, y: 0.349191558837891 },
          beta: { x: 0.559064247131347, y: 0.349191558837891 },
          gamma: { x: -1.118128494262694, y: -0.698383117675782 },
        },
        G: 1.0,
        speed: 1.0,
      },
    },
  };

  const curatedPresetOrder = [
    "figure-eight",
    "lagrange-triangle",
    "euler-collinear",
    "butterfly-i",
    "broucke",
    "henon",
    "moth-iii",
    "goggles",
    "dragonfly",
    "yarn",
  ];

  const liLiaoPresetRows = [
    ["I.A-1", 0.3471168881, 0.5327249454, 6.3259139829],
    ["I.A-2", 0.3068934205, 0.1255065670, 6.2346748391],
    ["I.A-3", 0.6150407229, 0.5226158545, 37.3205235945],
    ["I.A-4", 0.5379557207, 0.3414578545, 26.9186696160],
    ["I.A-5", 0.4112926910, 0.2607551013, 20.7490650080],
    ["I.A-6", 0.4425908552, 0.4235138348, 35.8334644158],
    ["I.A-7", 0.1214534165, 0.1012023800, 15.7440944954],
    ["I.A-8", 0.4094945913, 0.3628231655, 33.8677507235],
    ["I.A-9", 0.5255769251, 0.2501253528, 43.8698538026],
    ["I.A-10", 0.4121028725, 0.2833837497, 34.2470499687],
    ["I.A-11", 0.4364192674, 0.4457095477, 49.5954033190],
    ["I.A-12", 0.1182009612, 0.5847367662, 48.2723717545],
    ["I.A-13", 0.4763527642, 0.3789434497, 53.4714914343],
    ["I.A-14", 0.4027121690, 0.2100155085, 34.7120153702],
    ["I.A-15", 0.3960494651, 0.3529413931, 46.1340735475],
    ["I.A-16", 0.4340543928, 0.4606927255, 64.1162217970],
    ["I.A-17", 0.1842784887, 0.5871881740, 63.5343529785],
    ["I.A-18", 0.4580378828, 0.4093753024, 66.3519736810],
    ["I.A-19", 0.4152505707, 0.2913461808, 47.9254977196],
    ["I.A-20", 0.0969422653, 0.5615968396, 53.6899444096],
    ["I.A-21", 0.4082108156, 0.2436851904, 48.4868513719],
    ["I.A-22", 0.4289870678, 0.4723797648, 78.3984979261],
    ["I.A-23", 0.4138807521, 0.3477955684, 61.8447789156],
    ["I.A-24", 0.4905050535, 0.4044215155, 85.3859524958],
    ["I.A-25", 0.1982770999, 0.5760625510, 73.2768117405],
    ["I.A-26", 0.3991287659, 0.1847081193, 48.6673769352],
    ["I.A-27", 0.4151691260, 0.2953409098, 61.3228288140],
    ["I.A-28", 0.0490506729, 0.5901941115, 79.1518362736],
    ["I.A-29", 0.3447503346, 0.3930446386, 67.3877746400],
    ["I.A-30", 0.2203123981, 0.5718227262, 85.7935924161],
    ["I.A-31", 0.4441311511, 0.3823106072, 82.3618800834],
    ["I.A-32", 0.4041322114, 0.2191641945, 62.4468134238],
    ["I.A-33", 0.4089912496, 0.3457125084, 75.0210999574],
    ["I.A-34", 0.4572423635, 0.4074171858, 95.8806923191],
    ["I.A-35", 0.3972193787, 0.1691985386, 62.6275833821],
    ["I.A-36", 0.4160674674, 0.2971499303, 74.7892110946],
    ["I.A-37", 0.1038901209, 0.5907210858, 92.2887207815],
    ["I.A-38", 0.4135366646, 0.2710056059, 76.0285224477],
    ["I.A-39", 0.3967429300, 0.3708809839, 85.9343829011],
    ["I.A-40", 0.4073762182, 0.2388431491, 76.2219729678],
    ["I.A-41", 0.1334658448, 0.5838277552, 102.8155095976],
    ["I.A-42", 0.4015585101, 0.2022664462, 76.4010838847],
    ["I.A-43", 0.4157753114, 0.2981866614, 88.0489003051],
    ["I.A-44", 0.4188475683, 0.2770588072, 90.4212103693],
    ["I.A-45", 0.3960577146, 0.1586009694, 76.5926988984],
    ["I.A-46", 0.4096220179, 0.2516961122, 89.9866883856],
    ["I.A-47", 0.4046803380, 0.2225972157, 90.1813477230],
    ["I.A-48", 0.2744365569, 0.3448729405, 37.0281899697],
    ["I.A-49", 0.5196830772, 0.2059463323, 61.0651489089],
    ["I.A-50", 0.0481112024, 0.5584284134, 61.5066511920],
    ["I.A-51", 0.3240593189, 0.3665712251, 61.6980804867],
    ["I.A-52", 0.4392326535, 0.4490130778, 107.1704322355],
    ["I.A-53", 0.4157392818, 0.3443683086, 90.2692922120],
    ["I.A-54", 0.2591633491, 0.5655538324, 112.9677142326],
    ["I.A-55", 0.4372549674, 0.4568896400, 121.6765447969],
    ["I.A-56", 0.4713347232, 0.3856148608, 112.7807985048],
    ["I.A-57", 0.1538860573, 0.5805527776, 114.4056830978],
    ["I.A-58", 0.4162411626, 0.4666456940, 130.1232036082],
    ["I.A-59", 0.4602603277, 0.4047836526, 126.1735921874],
    ["I.A-60", 0.4260682804, 0.4689275280, 134.8572983004],
    ["I.A-61", 0.4115604103, 0.3439515057, 103.4777852547],
    ["I.A-62", 0.4538585041, 0.4151335211, 138.9526711783],
    ["I.A-63", 0.1807391308, 0.5804273075, 128.9311229083],
    ["I.A-64", 0.0616295799, 0.5887684684, 121.2588070481],
    ["I.A-65", 0.4164511851, 0.2985460701, 101.4417348354],
    ["I.A-66", 0.4755802612, 0.3834289883, 143.4920831622],
    ["I.A-67", 0.4189618506, 0.3575723235, 117.5497551541],
    ["I.A-68", 0.3998065241, 0.1898070007, 90.3562840799],
    ["I.A-69", 0.1938115742, 0.5776286093, 140.9274473884],
    ["I.A-70", 0.4311833725, 0.4733759409, 164.8353415245],
    ["I.A-71", 0.0960540551, 0.5889671026, 134.1667723286],
    ["I.A-72", 0.3952890968, 0.1508523182, 90.5619718006],
    ["I.A-73", 0.4395870869, 0.4502293684, 164.6132228870],
    ["I.A-74", 0.3674149486, 0.3838228297, 119.7236640531],
    ["I.A-75", 0.3939961214, 0.3865732823, 127.4002458975],
    ["I.A-76", 0.3430511121, 0.3718832371, 111.6289843304],
    ["I.A-77", 0.4159559963, 0.2988672319, 114.5882843578],
    ["I.A-78", 0.4069867693, 0.2365548555, 103.9566166835],
    ["I.A-79", 0.4589974678, 0.4050034288, 155.7660607190],
    ["I.A-80", 0.4139140441, 0.2867091579, 116.5535148563],
    ["I.A-81", 0.4379684294, 0.4556963530, 179.1036444528],
    ["I.A-82", 0.4126145620, 0.3435200139, 131.9570363471],
    ["I.A-83", 0.4561844518, 0.4117892184, 168.9508799790],
    ["I.A-84", 0.3985475384, 0.1801838327, 104.3138748764],
    ["I.A-85", 0.4126594494, 0.2674571676, 117.5120633437],
    ["I.A-86", 0.3921967782, 0.3732670713, 137.7155574878],
    ["I.A-87", 0.4180525186, 0.2985930530, 128.3273660780],
    ["I.A-88", 0.1382080826, 0.5834341742, 157.3466528910],
    ["I.A-89", 0.3974576989, 0.2491169363, 115.4448017793],
    ["I.A-90", 0.0188646524, 0.5900765061, 151.9903843649],
    ["I.A-91", 0.3947500473, 0.1449169673, 104.5346721644],
    ["I.A-92", 0.4146876683, 0.2893277049, 130.1851727452],
    ["I.A-93", 0.4049707755, 0.2243966352, 117.9157508493],
    ["I.A-94", 0.4948547469, 0.3816681253, 195.8237684806],
    ["I.A-95", 0.4098282065, 0.4859736518, 199.4325323563],
    ["I.A-96", 0.3557656112, 0.2101434426, 110.1033827881],
    ["I.A-97", 0.1458080611, 0.5760627737, 164.8777227366],
    ["I.A-98", 0.4373040972, 0.1890148898, 125.7688001626],
    ["I.A-99", 0.3693848766, 0.2787954099, 121.4331832032],
    ["I.A-100", 0.0670760777, 0.5889627892, 163.9101889958],
    ["I.A-101", 0.4024084539, 0.3670928188, 153.5887772816],
    ["I.A-102", 0.4101448519, 0.2545904027, 131.4852184733],
    ["I.A-103", 0.3976053675, 0.1724965035, 118.2740940483],
    ["I.A-104", 0.4070387234, 0.3507052842, 155.3531711573],
    ["I.A-105", 0.3654211421, 0.1497581124, 113.5033068728],
    ["I.A-106", 0.3288064734, 0.2480300294, 116.7651488382],
    ["I.A-107", 0.0921822548, 0.5888237645, 176.5993385200],
    ["I.A-108", 0.3943552252, 0.1402131694, 118.5101674005],
    ["I.A-109", 0.4164334853, 0.2763211125, 145.5011286545],
    ["I.A-110", 0.4033838433, 0.2143907433, 131.8709942386],
    ["I.A-111", 0.1818464802, 0.5795638348, 195.8266870843],
    ["I.A-112", 0.4109222799, 0.3490743143, 170.4845107382],
    ["I.A-113", 0.4159829843, 0.2928634271, 157.4236701613],
    ["I.A-114", 0.3968779003, 0.1661961334, 132.2368607224],
    ["I.A-115", 0.3369172422, 0.2901238678, 139.2379425543],
    ["I.A-116", 0.4786094582, 0.2027583452, 167.5764021354],
    ["I.A-117", 0.1262212709, 0.5844212753, 199.4597414280],
    ["I.A-118", 0.3596345346, 0.3768544947, 165.4459242130],
    ["I.A-119", 0.3735693647, 0.3814544097, 171.6871768580],
    ["I.A-120", 0.3940559464, 0.1363870337, 132.4879124177],
    ["I.A-121", 0.0398375597, 0.5900216545, 194.6214443391],
    ["I.A-122", 0.3366050958, 0.1545246545, 122.1507473925],
    ["I.A-123", 0.4148912516, 0.3594943116, 185.0089900186],
    ["I.A-124", 0.4021066869, 0.2059880758, 145.8250755871],
    ["I.A-125", 0.2984912721, 0.2642719294, 134.6157747992],
    ["I.A-126", 0.3151887676, 0.2026092096, 129.5701866405],
    ["I.A-127", 0.3682819786, 0.0540125357, 129.1627539603],
    ["I.A-128", 0.4094064944, 0.2504917575, 159.2238172130],
    ["I.A-129", 0.3963021063, 0.1609272065, 146.2019999818],
    ["I.A-130", 0.4858230168, 0.1897852046, 186.6816128151],
    ["I.A-131", 0.3938225013, 0.1332100629, 146.4674258412],
    ["I.A-132", 0.2844202818, 0.2576751665, 144.7361096869],
    ["I.A-133", 0.3613650149, 0.0662137880, 141.3166709722],
    ["I.A-134", 0.4052729644, 0.2262551267, 173.3843818847],
    ["I.A-135", 0.2792503345, 0.2309398618, 146.5213559661],
    ["I.A-136", 0.4088863339, 0.2475714173, 186.9603460122],
    ["I.A-137", 0.2755037979, 0.2512907499, 155.4548586490],
    ["I.A-138", 0.3000356874, 0.1954805934, 152.1599660045],
    ["I.A-139", 0.2759217512, 0.2671023857, 164.8956499133],
    ["I.A-140", 0.3060236507, 0.1574877923, 155.4631165813],
    ["I.A-141", 0.2738106556, 0.2266665399, 157.9002511121],
    ["I.A-142", 0.2716635736, 0.2803602873, 173.2990630202],
    ["I.A-143", 0.2690738475, 0.2460748830, 166.5414191753],
    ["I.A-144", 0.2813047676, 0.2931043691, 185.0094674080],
    ["I.A-145", 0.2844033114, 0.2864772055, 184.1463025888],
    ["I.A-146", 0.3406159593, 0.0878815592, 176.4815564147],
    ["I.A-147", 0.2745076841, 0.2185259293, 182.4778598891],
    ["I.A-148", 0.5236560165, 0.2615293843, 77.5451687834],
    ["I.A-149", 0.5252433392, 0.2395323622, 97.1790201428],
    ["I.A-150", 0.2485711669, 0.2285602706, 62.8143378441],
    ["I.A-151", 0.4717436769, 0.4159399383, 127.4097749092],
    ["I.A-152", 0.4244996083, 0.4906100936, 136.0765222404],
    ["I.A-153", 0.3303010815, 0.4704859697, 107.3481952603],
    ["I.A-154", 0.2538439618, 0.5599410925, 121.1861154175],
    ["I.A-155", 0.4824594978, 0.3739325421, 131.7096541850],
    ["I.A-156", 0.4299480127, 0.4772693278, 179.4317919632],
    ["I.A-157", 0.2242029652, 0.5716643145, 178.2257295831],
    ["I.A-158", 0.4721688158, 0.3825825184, 189.2718322389],
    ["I.A-159", 0.2338958736, 0.5689557210, 190.6014315264],
    ["I.A-160", 0.4067612870, 0.2352215102, 131.6910976773],
    ["I.A-161", 0.4664129400, 0.2183545493, 147.4412391934],
    ["I.A-162", 0.1082811863, 0.5839631505, 185.8736775605],
    ["I.A-163", 0.3733531828, 0.0372160210, 116.4750673801],
    ["I.A-164", 0.3289795673, 0.2068164036, 118.9835822292],
    ["I.A-165", 0.4000579116, 0.1916547891, 132.0453999094],
    ["I.A-166", 0.4122855598, 0.2657302751, 159.0067612686],
    ["I.A-167", 0.3897682267, 0.3744628158, 189.3994398298],
    ["I.A-168", 0.3218496119, 0.1559752782, 132.7019091118],
    ["I.A-169", 0.2959833070, 0.2812516245, 143.8012840531],
    ["I.A-170", 0.4132174699, 0.2698100668, 172.7929755123],
    ["I.A-171", 0.4010600790, 0.1988153634, 159.7793954306],
    ["I.A-172", 0.3983719278, 0.1787862095, 159.9605934536],
    ["I.A-173", 0.4134354098, 0.2854601690, 185.1176308487],
    ["I.A-174", 0.4920112032, 0.1412368522, 190.8552755255],
    ["I.A-175", 0.3958370784, 0.1564483425, 160.1693147940],
    ["I.A-176", 0.2816607693, 0.2752504513, 153.9063858244],
    ["I.A-177", 0.4155517978, 0.2960847052, 197.4708451315],
    ["I.A-178", 0.3124918736, 0.1567548343, 143.9064578456],
    ["I.A-179", 0.3936357530, 0.1305277271, 160.4482656408],
    ["I.A-180", 0.3977453372, 0.1736695550, 173.9208149453],
    ["I.A-181", 0.4065107464, 0.2337325768, 187.1598824391],
    ["I.A-182", 0.3934827897, 0.1282315783, 174.4300043958],
    ["I.A-183", 0.4514746238, 0.0973655800, 192.4707838219],
    ["I.A-184", 0.3994542144, 0.1871787471, 187.6908780809],
    ["I.A-185", 0.3466891157, 0.0826041253, 164.7857262001],
    ["I.A-186", 0.3951370317, 0.1492265626, 188.1097039559],
    ["I.A-187", 0.2704861637, 0.2617400496, 176.1949991668],
    ["I.A-188", 0.2701991673, 0.2977922273, 183.6255697046],
    ["I.A-189", 0.2719181145, 0.2227169845, 169.8054736884],
    ["I.A-190", 0.3933545122, 0.1262431781, 188.4122024989],
    ["I.B-1", 0.4644451728, 0.3960600146, 14.8943051743],
    ["I.B-2", 0.4059155671, 0.2301631260, 13.8671234361],
    ["I.B-3", 0.0833000718, 0.1278892555, 10.4648495256],
    ["I.B-4", 0.0805842255, 0.5888360898, 21.2723373956],
    ["I.B-5", 0.4391659182, 0.4529676431, 28.6692709402],
    ["I.B-6", 0.3834435199, 0.3773636946, 25.8392363356],
    ["I.B-7", 0.1862378160, 0.5787138661, 33.6414187604],
    ["I.B-8", 0.4290898149, 0.4753132903, 42.8299661050],
    ["I.B-9", 0.4149129608, 0.2746187551, 27.6646471048],
    ["I.B-10", 0.3980444335, 0.1761383334, 27.8234143343],
    ["I.B-11", 0.2302567240, 0.5696545030, 46.0668997027],
    ["I.B-12", 0.4281877764, 0.3550351874, 42.3641397966],
    ["I.B-13", 0.3580870041, 0.4976954491, 49.6315066172],
    ["I.B-14", 0.4097171234, 0.4392219554, 54.0572550607],
    ["I.B-15", 0.4143481483, 0.2881031095, 41.1260553556],
    ["I.B-16", 0.2590629830, 0.5643154612, 59.1751946306],
    ["I.B-17", 0.3956370780, 0.1544499871, 41.7884305464],
    ["I.B-18", 0.4092519851, 0.3498343142, 54.3261092062],
    ["I.B-19", 0.2776121408, 0.5600955198, 72.2975181708],
    ["I.B-20", 0.4174078020, 0.2932839393, 54.8606819583],
    ["I.B-21", 0.4110550483, 0.4029989043, 71.3849893061],
    ["I.B-22", 0.4099321826, 0.2534182814, 55.3680130042],
    ["I.B-23", 0.1287022901, 0.5842440794, 75.5738965721],
    ["I.B-24", 0.4019178915, 0.2047154472, 55.5565256091],
    ["I.B-25", 0.4532653563, 0.4161260139, 87.6578887763],
    ["I.B-26", 0.4156793762, 0.2964031093, 68.0656402822],
    ["I.B-27", 0.4805889690, 0.3753996716, 92.5604403814],
    ["I.B-28", 0.4282751070, 0.4640165419, 98.6494595687],
    ["I.B-29", 0.1551825144, 0.5792904049, 86.8760972509],
    ["I.B-30", 0.3388749658, 0.2763529104, 61.2294979456],
    ["I.B-31", 0.4124421756, 0.2664662522, 69.1294839452],
    ["I.B-32", 0.3751487886, 0.0241612662, 54.9741990396],
    ["I.B-33", 0.4125928452, 0.3449403658, 82.6214161579],
    ["I.B-34", 0.4757948431, 0.1603050376, 79.9971544120],
    ["I.B-35", 0.4141289440, 0.2980760641, 81.1505833629],
    ["I.B-36", 0.3212269533, 0.2046903079, 62.0875306826],
    ["I.B-37", 0.4039945439, 0.3662946692, 93.7855168318],
    ["I.B-38", 0.3939323748, 0.1347283909, 69.7387381695],
    ["I.B-39", 0.2904226486, 0.2609195136, 69.7665857553],
    ["I.B-40", 0.4942684807, 0.2201949355, 98.6353340741],
    ["I.B-41", 0.3650027028, 0.0605128530, 67.6506508279],
    ["I.B-42", 0.4160188002, 0.2984267206, 94.7278887029],
    ["I.B-43", 0.4032437210, 0.2134855934, 83.2915115056],
    ["I.B-44", 0.2995058112, 0.2924056736, 80.3687190155],
    ["I.B-45", 0.4954934838, 0.1360770719, 100.4005086563],
    ["I.B-46", 0.3029165156, 0.1970668629, 73.2064153230],
    ["I.B-47", 0.4105107221, 0.2565879477, 96.8662425654],
    ["I.B-48", 0.3935556862, 0.1293368487, 83.7195247407],
    ["I.B-49", 0.3501125857, 0.0793401820, 79.4749538995],
    ["I.B-50", 0.4013534478, 0.2008553668, 97.2456382734],
    ["I.B-51", 0.2666293299, 0.2779915428, 89.2809106554],
    ["I.B-52", 0.2935043434, 0.1914491983, 84.8189274623],
    ["I.B-53", 0.3969872473, 0.1671666821, 97.4321722312],
    ["I.B-54", 0.3932974661, 0.1253456024, 97.7016625145],
    ["I.B-55", 0.4030477277, 0.0469627166, 99.9681279479],
    ["I.B-56", 0.4012891619, 0.4985422646, 68.5536700625],
    ["I.B-57", 0.2840814898, 0.5556089363, 83.9820579378],
    ["I.B-58", 0.4391638095, 0.3451673262, 72.9606345288],
    ["I.B-59", 0.3945382374, 0.1424370298, 55.7610531376],
    ["I.B-60", 0.4812679815, 0.2803015236, 93.0193545419],
    ["I.B-61", 0.4567265227, 0.4110980415, 117.6542984464],
    ["I.B-62", 0.1998578918, 0.5751811878, 112.6005586813],
    ["I.B-63", 0.4731193722, 0.3817523595, 121.3718607541],
    ["I.B-64", 0.4324559260, 0.4468425955, 125.9650168972],
    ["I.B-65", 0.4329467422, 0.4287307557, 126.6430122618],
    ["I.B-66", 0.1106525804, 0.5843723566, 117.2006330167],
    ["I.B-67", 0.2160100270, 0.5721577857, 125.2096376354],
    ["I.B-68", 0.4139613585, 0.3600046586, 109.4116313918],
    ["I.B-69", 0.1346825430, 0.5825466616, 129.3971645144],
    ["I.B-70", 0.4155669785, 0.2988428103, 107.8898275282],
    ["I.B-71", 0.4601989074, 0.4074300958, 148.0286393030],
    ["I.B-72", 0.4358120735, 0.4591466107, 157.2189925171],
    ["I.B-73", 0.4132841481, 0.2851290367, 109.6943890164],
    ["I.B-74", 0.1522366536, 0.5809723053, 141.6339896130],
    ["I.B-75", 0.0426815497, 0.5900333430, 136.8666399610],
    ["I.B-76", 0.4119987609, 0.2643427092, 110.6260549697],
    ["I.B-77", 0.5118118742, 0.2366710013, 136.7985866536],
    ["I.B-78", 0.4571979692, 0.4150480887, 161.5490315022],
    ["I.B-79", 0.4079238316, 0.2420300626, 110.8414293129],
    ["I.B-80", 0.4161585901, 0.2988955475, 121.2499818512],
    ["I.B-81", 0.1774072601, 0.5821912520, 157.3853633779],
    ["I.B-82", 0.5142298286, 0.2568912491, 152.2860975586],
    ["I.B-83", 0.4039097291, 0.2177564200, 111.0262814993],
    ["I.B-84", 0.4445769891, 0.4487033431, 188.8772873282],
    ["I.B-85", 0.3999556835, 0.1909060542, 111.2008319293],
    ["I.B-86", 0.4133120318, 0.2701767161, 124.4101367285],
    ["I.B-87", 0.1066778795, 0.5948382311, 165.7269258467],
    ["I.B-88", 0.4158199333, 0.2990314521, 134.3908162915],
    ["I.B-89", 0.3985640110, 0.3698314086, 145.9028456537],
    ["I.B-90", 0.4094842993, 0.2509272653, 124.6052699892],
    ["I.B-91", 0.5128091369, 0.2180249116, 154.2378088693],
    ["I.B-92", 0.3962177869, 0.1601311749, 111.3973050444],
    ["I.B-93", 0.4149780095, 0.2904029941, 136.9824352416],
    ["I.B-94", 0.4540683260, 0.4147166692, 190.2328210125],
    ["I.B-95", 0.4035798187, 0.3517272858, 147.4168577881],
    ["I.B-96", 0.3931011977, 0.1222707697, 111.6831379999],
    ["I.B-97", 0.1229330287, 0.5846239911, 172.1857297973],
    ["I.B-98", 0.2584123338, 0.2319416805, 103.4515732794],
    ["I.B-99", 0.4023586867, 0.2076743922, 124.9805591011],
    ["I.B-100", 0.3989023581, 0.0587531871, 113.4691210308],
    ["I.B-101", 0.4367428362, 0.3606385790, 172.3247110027],
    ["I.B-102", 0.4784306757, 0.3771895698, 199.5148149879],
    ["I.B-103", 0.4064178832, 0.3648162353, 161.5522956612],
    ["I.B-104", 0.1395147893, 0.5832722105, 184.5789530252],
    ["I.B-105", 0.0532000567, 0.5910456775, 180.2118985604],
    ["I.B-106", 0.4155474891, 0.2921682541, 150.5786020101],
    ["I.B-107", 0.4075222377, 0.2396965085, 138.5765198727],
    ["I.B-108", 0.3451744845, 0.3808525684, 155.6845054611],
    ["I.B-109", 0.4043102769, 0.2202849054, 138.7609319540],
    ["I.B-110", 0.4218640175, 0.2770211780, 153.8442992753],
    ["I.B-111", 0.3929297393, 0.1198339408, 125.6607884377],
    ["I.B-112", 0.1502500844, 0.5819772796, 196.4574240736],
    ["I.B-113", 0.2563482201, 0.2261374828, 115.3093440018],
    ["I.B-114", 0.4122588665, 0.3610576585, 177.1374986605],
    ["I.B-115", 0.4011284717, 0.1992930016, 138.9348056259],
    ["I.B-116", 0.3970105843, 0.0653064641, 127.2370563374],
    ["I.B-117", 0.4123635119, 0.3484019438, 177.9654310661],
    ["I.B-118", 0.0148838157, 0.5682653432, 184.4789881904],
    ["I.B-119", 0.2606923122, 0.2911653502, 130.7643465810],
    ["I.B-120", 0.4178518268, 0.3580393477, 193.1285092053],
    ["I.B-121", 0.4127521388, 0.2678683319, 165.8951639982],
    ["I.B-122", 0.4030019190, 0.2119143431, 152.7155517041],
    ["I.B-123", 0.3927437429, 0.1178691817, 139.6277439076],
    ["I.B-124", 0.4147362902, 0.2949369415, 177.1359109432],
    ["I.B-125", 0.3193090588, 0.1018501668, 126.8823101525],
    ["I.B-126", 0.4001323444, 0.1921976871, 152.8899791889],
    ["I.B-127", 0.4129154675, 0.2844468071, 178.2176770073],
    ["I.B-128", 0.3973680105, 0.1704797689, 153.0783295506],
    ["I.B-129", 0.4072545124, 0.2381300512, 166.3113175694],
    ["I.B-130", 0.4045775130, 0.2219569575, 166.4954609423],
    ["I.B-131", 0.3948281582, 0.1458085489, 153.3085182072],
    ["I.B-132", 0.4108695302, 0.2585197447, 179.8624087934],
    ["I.B-133", 0.3924554987, 0.1162941173, 153.5622330784],
    ["I.B-134", 0.4083876444, 0.2446989126, 180.0795834157],
    ["I.B-135", 0.3952920978, 0.0730045437, 155.0210535632],
    ["I.B-136", 0.4116924345, 0.2628122619, 193.6216330479],
    ["I.B-137", 0.3445561301, 0.2603927098, 174.5534838128],
    ["I.B-138", 0.4010075001, 0.1984472605, 180.6239886836],
    ["I.B-139", 0.3493341960, 0.2098620100, 166.9519921840],
    ["I.B-140", 0.3915508594, 0.1152445699, 167.3247662290],
    ["I.B-141", 0.3986254119, 0.1807988654, 180.8044298919],
    ["I.B-142", 0.4336920022, 0.1476782466, 192.7791207202],
    ["I.B-143", 0.3963541512, 0.1614152259, 181.0067311093],
    ["I.B-144", 0.4024848426, 0.2085131141, 194.4045903694],
    ["I.B-145", 0.3942996878, 0.1395218939, 181.2594734783],
    ["I.B-146", 0.3190182619, 0.2561011852, 181.2227405768],
    ["I.B-147", 0.3321031966, 0.2075124897, 175.9799936209],
    ["I.B-148", 0.4002334723, 0.1929322974, 194.5791562365],
    ["I.B-149", 0.3941006143, 0.1369745839, 195.2372295764],
    ["I.B-150", 0.3135653929, 0.2823975233, 199.6963199692],
    ["I.B-151", 0.3028596325, 0.2513678491, 190.0141857350],
    ["I.B-152", 0.3448466385, 0.1310471303, 182.8204654697],
    ["I.B-153", 0.3016985230, 0.2653178570, 199.5506880072],
    ["I.B-154", 0.2998118429, 0.2294251194, 191.7840057235],
    ["I.B-155", 0.3310536467, 0.1351316515, 192.5759642513],
    ["I.B-156", 0.3980393062, 0.5038904789, 82.2493251383],
    ["I.B-157", 0.2952861660, 0.5534590851, 97.3499809159],
    ["I.B-158", 0.4798380897, 0.4113090190, 106.5560380694],
    ["I.B-159", 0.4137787743, 0.3437200842, 111.0557458846],
    ["I.B-160", 0.3682877800, 0.3998940275, 116.9320547074],
    ["I.B-161", 0.4646477988, 0.3883460870, 149.4861493038],
    ["I.B-162", 0.4031162525, 0.4617331826, 155.9939695150],
    ["I.B-163", 0.4238959747, 0.4719118617, 170.7096365279],
    ["I.B-164", 0.4207783634, 0.4487423577, 176.2188318361],
    ["I.B-165", 0.4554244658, 0.4087724748, 176.4254157280],
    ["I.B-166", 0.5090827977, 0.1065690769, 138.5002592220],
    ["I.B-167", 0.3988858353, 0.1828353597, 125.1579036819],
    ["I.B-168", 0.4107436209, 0.2578452663, 138.3643307774],
    ["I.B-169", 0.5114846883, 0.1521301286, 172.1153250253],
    ["I.B-170", 0.4088301474, 0.2472647559, 152.3413800632],
    ["I.B-171", 0.3611442582, 0.3727080944, 171.2956907056],
    ["I.B-172", 0.2815716369, 0.1833006566, 120.7209378107],
    ["I.B-173", 0.3951862673, 0.1497568031, 139.3358032464],
    ["I.B-174", 0.4158315105, 0.3472324558, 193.3502089464],
    ["I.B-175", 0.4137016788, 0.2715755177, 179.7068265589],
    ["I.B-176", 0.4153946800, 0.2957299894, 190.7321992213],
    ["I.B-177", 0.3993116206, 0.1861014901, 166.8464696440],
    ["I.B-178", 0.4138089784, 0.2864083402, 191.9755354947],
    ["I.B-179", 0.3968143060, 0.1656275217, 167.0415888648],
    ["I.B-180", 0.4034485563, 0.2148073995, 180.4504761328],
    ["I.B-181", 0.4093563853, 0.2502114533, 193.8423157244],
    ["I.B-182", 0.4443735176, 0.1849048718, 194.9787589138],
    ["I.B-183", 0.3948446667, 0.0755442635, 168.9641243034],
    ["I.B-184", 0.3520864423, 0.1736619942, 169.5279904498],
    ["I.B-185", 0.3288872593, 0.2366097357, 173.0921124629],
    ["I.B-186", 0.3691268433, 0.1230538137, 175.3859687881],
    ["I.B-187", 0.3945254084, 0.0775864607, 182.9237531924],
    ["I.B-188", 0.3304190862, 0.1753063381, 177.6311331786],
    ["I.B-189", 0.3942881027, 0.0792702101, 196.8942769930],
    ["I.B-190", 0.3165116655, 0.1757233721, 187.3222444953],
    ["I.B-191", 0.3134547198, 0.2019372816, 197.1007090614],
    ["II.A-1", 0.4239199957, 0.4890252375, 121.7417821220],
    ["II.A-2", 0.4210931065, 0.4930983422, 135.8627697832],
    ["II.A-3", 0.3202131331, 0.3028156498, 145.3317595261],
    ["II.A-4", 0.0262032843, 0.6907471490, 46.5767068651],
    ["II.B-1", 0.3962186234, 0.5086826315, 96.4358796119],
    ["II.B-2", 0.2517755120, 0.2667371937, 99.8166259190],
    ["II.B-3", 0.5091186403, 0.1142951579, 120.8830891862],
    ["II.B-4", 0.2070614316, 0.5772071599, 183.2613461906],
    ["II.B-5", 0.2465911029, 0.2579795310, 111.2623782794],
    ["II.B-6", 0.0699202568, 0.6190218805, 95.2884025970],
    ["II.B-7", 0.3956548748, 0.5097716060, 109.8746683440],
    ["II.B-8", 0.3064804236, 0.5513199378, 111.1933380875],
    ["II.B-9", 0.5122100376, 0.1633529632, 155.0269037645],
    ["II.B-10", 0.5152772213, 0.2342147738, 189.7694426662],
    ["II.C-1", 0.2827020949, 0.3272089716, 10.9633031497],
    ["II.C-2", 0.5647061130, 0.5368389792, 54.7501910522],
    ["II.C-3", 0.5225201635, 0.2268083872, 26.3193848826],
    ["II.C-4", 0.2016783093, 0.4098955437, 21.0205158972],
    ["II.C-5", 0.5512729728, 0.5504821832, 86.9417019465],
    ["II.C-6", 0.5233890828, 0.3421147815, 44.9302453896],
    ["II.C-7", 0.4737427040, 0.4312766992, 46.8946539631],
    ["II.C-8", 0.2433845587, 0.2505166924, 22.3333787897],
    ["II.C-9", 0.1739184309, 0.1140843875, 21.7535340992],
    ["II.C-10", 0.1448119296, 0.5428981413, 38.0630301501],
    ["II.C-11", 0.1359037483, 0.5406786957, 37.5276119206],
    ["II.C-12", 0.5547060649, 0.2721678509, 52.9480727303],
    ["II.C-13", 0.4458173723, 0.4924872346, 62.5459036895],
    ["II.C-14", 0.5368578744, 0.3705761039, 60.5607353967],
    ["II.C-15", 0.5196491506, 0.3533207146, 57.9902773954],
    ["II.C-16", 0.2449726867, 0.5690681065, 52.9395192839],
    ["II.C-17", 0.5164575299, 0.1638309455, 43.4746638318],
    ["II.C-18", 0.4052765310, 0.4961906801, 62.2999748903],
    ["II.C-19", 0.1868592137, 0.2044548811, 27.7253651277],
    ["II.C-20", 0.3026158825, 0.3576846960, 37.1769633336],
    ["II.C-21", 0.5044568709, 0.3973785294, 70.8348253915],
    ["II.C-22", 0.2661160110, 0.5520357440, 62.9864913052],
    ["II.C-23", 0.2865945055, 0.5607550065, 67.5864018030],
    ["II.C-24", 0.0882838085, 0.3615155443, 35.8170122339],
    ["II.C-25", 0.5159476361, 0.1444933284, 52.2126924444],
    ["II.C-26", 0.3970546540, 0.4996659112, 74.4041641681],
    ["II.C-27", 0.4168220336, 0.3303332949, 55.7893112814],
    ["II.C-28", 0.2663548692, 0.3359619580, 43.5341483568],
    ["II.C-29", 0.4293246983, 0.3737393096, 64.8733105441],
    ["II.C-30", 0.2542679242, 0.2153811120, 40.5931469775],
    ["II.C-31", 0.5059387393, 0.3894005400, 86.4180127242],
    ["II.C-32", 0.4110200317, 0.4114629190, 72.8712103518],
    ["II.C-33", 0.4158187604, 0.3068035415, 60.1507436615],
    ["II.C-34", 0.4480473854, 0.4596449839, 96.8391326694],
    ["II.C-35", 0.4177015960, 0.3034552740, 66.7511112061],
    ["II.C-36", 0.2710171846, 0.5711013679, 93.0418702843],
    ["II.C-37", 0.3499168589, 0.2508093737, 56.8351605485],
    ["II.C-38", 0.3783890881, 0.5100736088, 98.6023217127],
    ["II.C-39", 0.4270829576, 0.3403174863, 80.0382219001],
    ["II.C-40", 0.1703649368, 0.5803609520, 94.1583429936],
    ["II.C-41", 0.4762205782, 0.2687092179, 85.3959959932],
    ["II.C-42", 0.4318334213, 0.1223893080, 66.8092062353],
    ["II.C-43", 0.4146425708, 0.3012162581, 79.2835610170],
    ["II.C-44", 0.2710036741, 0.3121152228, 63.3936161404],
    ["II.C-45", 0.4234217026, 0.2989326748, 87.2610777514],
    ["II.C-46", 0.3282929621, 0.1554041101, 63.6556668110],
    ["II.C-47", 0.2950615495, 0.2386718494, 65.2298654293],
    ["II.C-48", 0.4069563704, 0.3543774452, 94.7746114120],
    ["II.C-49", 0.4182604701, 0.2994822960, 92.9809890454],
    ["II.C-50", 0.2881254754, 0.2779750581, 74.3601049133],
    ["II.C-51", 0.2833115180, 0.2333212957, 70.5062877151],
    ["II.C-52", 0.4473380629, 0.1056541774, 84.0347942344],
    ["II.C-53", 0.4121687384, 0.3002886778, 98.4332144983],
    ["II.C-54", 0.3351806004, 0.3540343105, 96.9055687195],
    ["II.C-55", 0.2761024483, 0.2287323888, 76.0753942955],
    ["II.C-56", 0.4502872480, 0.0999875045, 92.1831437265],
    ["II.C-57", 0.2793033126, 0.2712019544, 79.7728571001],
    ["II.C-58", 0.2723827379, 0.2246817404, 81.8883337850],
    ["II.C-59", 0.2726258099, 0.2206843436, 88.0168046313],
    ["II.C-60", 0.2769769990, 0.2163211708, 94.5261869045],
    ["II.C-61", 0.6696859765, 0.4862798575, 111.6735511043],
    ["II.C-62", 0.1467711144, 0.1988238982, 15.5852040984],
    ["II.C-63", 0.2980305901, 0.6485348678, 63.9306478929],
    ["II.C-64", 0.1066062988, 0.2369740501, 21.4593318053],
    ["II.C-65", 0.1189697937, 0.5386581099, 41.4367113206],
    ["II.C-66", 0.1349579489, 0.1388158691, 26.9173582655],
    ["II.C-67", 0.0190962965, 0.7880982771, 174.4738106853],
    ["II.C-68", 0.5313917017, 0.3440533419, 72.8917817632],
    ["II.C-69", 0.1983287250, 0.1083646402, 33.1578999528],
    ["II.C-70", 0.3961359419, 0.5075990479, 82.9095584181],
    ["II.C-71", 0.3890589703, 0.4364126051, 67.5933134073],
    ["II.C-72", 0.4662602934, 0.4781121788, 97.8521357163],
    ["II.C-73", 0.3912900930, 0.5083913706, 88.5152268416],
    ["II.C-74", 0.0475462969, 0.5646588375, 72.4005108986],
    ["II.C-75", 0.2744207740, 0.5580117379, 89.1716635083],
    ["II.C-76", 0.3631543956, 0.4101572180, 72.5369395460],
    ["II.C-77", 0.2855135908, 0.5556857756, 90.2667574352],
    ["II.C-78", 0.2575762954, 0.2092185043, 46.7559266660],
    ["II.C-79", 0.2825899895, 0.5574593048, 96.3976373998],
    ["II.C-80", 0.4617804462, 0.3849338004, 101.4930532952],
    ["II.C-81", 0.4456464329, 0.3434928347, 89.2721503494],
    ["II.C-82", 0.3379452918, 0.5474555148, 117.6340486503],
    ["II.C-83", 0.3129165204, 0.5484741376, 111.5227089594],
    ["II.C-84", 0.2968893204, 0.5439638834, 106.0964315543],
    ["II.C-85", 0.2512495838, 0.5669129966, 106.1149733422],
    ["II.C-86", 0.3992808324, 0.5094959441, 124.2440256690],
    ["II.C-87", 0.2254087369, 0.3469436377, 66.3522685919],
    ["II.C-88", 0.5234738074, 0.3430125576, 122.6793293886],
    ["II.C-89", 0.2645261109, 0.5649476217, 113.7789661432],
    ["II.C-90", 0.3753943858, 0.5199969079, 127.3458631987],
    ["II.C-91", 0.3734356168, 0.5183824717, 125.9373100767],
    ["II.C-92", 0.4243049239, 0.4900563659, 135.7270472138],
    ["II.C-93", 0.4778578506, 0.4362351173, 138.1973477797],
    ["II.C-94", 0.4478725342, 0.4242755759, 121.1471674140],
    ["II.C-95", 0.3680416437, 0.5200194559, 131.2837960007],
    ["II.C-96", 0.4439740574, 0.4220558056, 122.5262152360],
    ["II.C-97", 0.5049855347, 0.4003409209, 143.1429402354],
    ["II.C-98", 0.3619688366, 0.5160511236, 131.3618489148],
    ["II.C-99", 0.4963272196, 0.2750082245, 111.8364019177],
    ["II.C-100", 0.1600479685, 0.5830974531, 121.7551058696],
    ["II.C-101", 0.5102908231, 0.3575901413, 144.7874249037],
    ["II.C-102", 0.5032871392, 0.2685375206, 123.6355912506],
    ["II.C-103", 0.4831068889, 0.3429708664, 133.0041037254],
    ["II.C-104", 0.4600987572, 0.4389868308, 154.3254142371],
    ["II.C-105", 0.4135304700, 0.2998696032, 105.2365923011],
    ["II.C-106", 0.4300124259, 0.3554749370, 120.2233121235],
    ["II.C-107", 0.4128800187, 0.4868642357, 159.3592373143],
    ["II.C-108", 0.2337840221, 0.4711247940, 107.6906838559],
    ["II.C-109", 0.5021284225, 0.4265371911, 178.9211696576],
    ["II.C-110", 0.2164867425, 0.5799872016, 146.6171327324],
    ["II.C-111", 0.3579867923, 0.3621287896, 108.4386863974],
    ["II.C-112", 0.4031141443, 0.5020964921, 165.8327705497],
    ["II.C-113", 0.4481845220, 0.3602811878, 132.3386808547],
    ["II.C-114", 0.5500731263, 0.3814634479, 196.2411230097],
    ["II.C-115", 0.3562032573, 0.5250003095, 161.1788109414],
    ["II.C-116", 0.4118599465, 0.3432155311, 120.0533167933],
    ["II.C-117", 0.4801960806, 0.2871406271, 129.0160097094],
    ["II.C-118", 0.5371658731, 0.3984943066, 195.6689329179],
    ["II.C-119", 0.2725820526, 0.2644346962, 85.2269842957],
    ["II.C-120", 0.4500287021, 0.4212626102, 157.2987714029],
    ["II.C-121", 0.4438767435, 0.4225775888, 158.5428263415],
    ["II.C-122", 0.0931957583, 0.5754064016, 137.7843111275],
    ["II.C-123", 0.4175301746, 0.3430957060, 128.7472932221],
    ["II.C-124", 0.3600187937, 0.5221797725, 173.6222271714],
    ["II.C-125", 0.3806272915, 0.3501131016, 126.6161436477],
    ["II.C-126", 0.3837791731, 0.3569518329, 129.0860797033],
    ["II.C-127", 0.0715935321, 0.5614606957, 139.6739967734],
    ["II.C-128", 0.5084896856, 0.3971173995, 198.1578809274],
    ["II.C-129", 0.5129886961, 0.1995185091, 146.1306716825],
    ["II.C-130", 0.2239434477, 0.5629809053, 166.9610126801],
    ["II.C-131", 0.3646073207, 0.2326179920, 110.5223988488],
    ["II.C-132", 0.3758809553, 0.3714191733, 139.4763383031],
    ["II.C-133", 0.4079687070, 0.3467946424, 142.9574365649],
    ["II.C-134", 0.2582557078, 0.2986633497, 104.3188859584],
    ["II.C-135", 0.2613665653, 0.3010646289, 108.3619916341],
    ["II.C-136", 0.3955814740, 0.3842771664, 154.1379803565],
    ["II.C-137", 0.3455455677, 0.3273880159, 126.5531673809],
    ["II.C-138", 0.3385794074, 0.2315252500, 112.9484622797],
    ["II.C-139", 0.3578601157, 0.1829928242, 111.3983832975],
    ["II.C-140", 0.2662199199, 0.2617288091, 107.5138953175],
    ["II.C-141", 0.4458373407, 0.4219085904, 195.1709699750],
    ["II.C-142", 0.4161228347, 0.3579128439, 158.2418427194],
    ["II.C-143", 0.4104164725, 0.3814951548, 166.1586070391],
    ["II.C-144", 0.0693693379, 0.6033646696, 184.4392377108],
    ["II.C-145", 0.4735978920, 0.2313177546, 156.9836879900],
    ["II.C-146", 0.4799888062, 0.2624795421, 166.2000474547],
    ["II.C-147", 0.4637112431, 0.2858923789, 164.6023344184],
    ["II.C-148", 0.5206456110, 0.2383685944, 183.3096591850],
    ["II.C-149", 0.4175792025, 0.3246498436, 159.0527052142],
    ["II.C-150", 0.5093497308, 0.1590840316, 162.6587265245],
    ["II.C-151", 0.0683834774, 0.5833653062, 181.4427818832],
    ["II.C-152", 0.4639950316, 0.3539989419, 196.2961464240],
    ["II.C-153", 0.3518330832, 0.3639937352, 155.4205568976],
    ["II.C-154", 0.3153981646, 0.2969797915, 136.0121995709],
    ["II.C-155", 0.4099850242, 0.3706053839, 184.4454176663],
    ["II.C-156", 0.3231926176, 0.3279135713, 145.3798952880],
    ["II.C-157", 0.4771765515, 0.1801229299, 167.7213251594],
    ["II.C-158", 0.2973959601, 0.2543194648, 129.5705475970],
    ["II.C-159", 0.3134720455, 0.1840666537, 124.0700355615],
    ["II.C-160", 0.4160632302, 0.3349978893, 182.5440752184],
    ["II.C-161", 0.3358161544, 0.3881164707, 172.8143824669],
    ["II.C-162", 0.4870167590, 0.2099302469, 186.5727277418],
    ["II.C-163", 0.2969877047, 0.2221255009, 132.0216562587],
    ["II.C-164", 0.4156609919, 0.3579596922, 199.4409746332],
    ["II.C-165", 0.4871928568, 0.1661495427, 187.7801397568],
    ["II.C-166", 0.3638592241, 0.3770170533, 191.6726449737],
    ["II.C-167", 0.2985413068, 0.3181960211, 160.2142776167],
    ["II.C-168", 0.3102533155, 0.3277636570, 165.3209382776],
    ["II.C-169", 0.3098999619, 0.3285015035, 165.4253970148],
    ["II.C-170", 0.2767271690, 0.2447992873, 144.7823792155],
    ["II.C-171", 0.4388627404, 0.2371915812, 190.4374989777],
    ["II.C-172", 0.3625783597, 0.3645069408, 195.6153329373],
    ["II.C-173", 0.4277449853, 0.2640042862, 192.0213587611],
    ["II.C-174", 0.3729712940, 0.2250121941, 165.0090445138],
    ["II.C-175", 0.2888390504, 0.2160604105, 149.4648328243],
    ["II.C-176", 0.3666419820, 0.1916460944, 165.3779094251],
    ["II.C-177", 0.2884663698, 0.1819781618, 151.5859612492],
    ["II.C-178", 0.3749871963, 0.1474830882, 169.2093364950],
    ["II.C-179", 0.3017673304, 0.3279588878, 185.8778154983],
    ["II.C-180", 0.2920863313, 0.2113564265, 162.4404868020],
    ["II.C-181", 0.3363227387, 0.1931223679, 171.4994464900],
    ["II.C-182", 0.2965212394, 0.3180127676, 192.7713804348],
    ["II.C-183", 0.3263964865, 0.1928214109, 175.7091618817],
    ["II.C-184", 0.3066734671, 0.2613669948, 189.5879550733],
    ["II.C-185", 0.2992280886, 0.1590598797, 173.1881049209],
    ["II.C-186", 0.3117925543, 0.1916312640, 185.1588528533],
    ["II.C-187", 0.3033738636, 0.2176185571, 193.8770772063],
    ["II.C-188", 0.2604465076, 0.2256869065, 196.6479293263],
    ["II.C-189", 0.0667327899, 0.2912867569, 13.3697110598],
    ["II.C-190", 0.0539725385, 0.3917593746, 15.2796210778],
    ["II.C-191", 0.4271293811, 0.6282376589, 58.8959853789],
    ["II.C-192", 0.1459197548, 0.0434579988, 16.8197113393],
    ["II.C-193", 0.0734343088, 0.2956785083, 22.4013173133],
    ["II.C-194", 0.5555876261, 0.4214936039, 75.1051252007],
    ["II.C-195", 0.1873991947, 0.4829394618, 40.3052946558],
    ["II.C-196", 0.3268704330, 0.4439931746, 46.4481084914],
    ["II.C-197", 0.0772553729, 0.0962935023, 25.8396411521],
    ["II.C-198", 0.4805076338, 0.5832469030, 131.5712571441],
    ["II.C-199", 0.0759936918, 0.2997588242, 31.5191656332],
    ["II.C-200", 0.2513336605, 0.3012408423, 37.4214190867],
    ["II.C-201", 0.2224798560, 0.3218943929, 38.7911677318],
    ["II.C-202", 0.1727411576, 0.3365007421, 39.3444245245],
    ["II.C-203", 0.3449378402, 0.4918716974, 72.6547174942],
    ["II.C-204", 0.3984837145, 0.4527620517, 76.7667464654],
    ["II.C-205", 0.3107903232, 0.4359615931, 67.9349980910],
    ["II.C-206", 0.0995077146, 0.3957710385, 51.8957289725],
    ["II.C-207", 0.2712629218, 0.5766902452, 95.1895194685],
    ["II.C-208", 0.3791031878, 0.5143377515, 100.3150104107],
    ["II.C-209", 0.2816496180, 0.3514755712, 60.0376470543],
    ["II.C-210", 0.3851685224, 0.5086415312, 106.2835399139],
    ["II.C-211", 0.4036022580, 0.5028840213, 109.6282058892],
    ["II.C-212", 0.3011541892, 0.5487167377, 102.8385494278],
    ["II.C-213", 0.3082337510, 0.5516573762, 105.5334666717],
    ["II.C-214", 0.5201916309, 0.2123324421, 87.2860842631],
    ["II.C-215", 0.2512381225, 0.3272400470, 61.3992062163],
    ["II.C-216", 0.3800232997, 0.5162361284, 114.2142913903],
    ["II.C-217", 0.3975219956, 0.4882458860, 112.4811763381],
    ["II.C-218", 0.1829585594, 0.2103495753, 55.5611081365],
    ["II.C-219", 0.3085347089, 0.5520329973, 118.2139479118],
    ["II.C-220", 0.4492249567, 0.4587831231, 127.0667084547],
    ["II.C-221", 0.3837232497, 0.5140136806, 127.4087704175],
    ["II.C-222", 0.3434370240, 0.3432358104, 80.1579217509],
    ["II.C-223", 0.3085741714, 0.5449851912, 121.1980464816],
    ["II.C-224", 0.5144801407, 0.2857654410, 117.3488690365],
    ["II.C-225", 0.2872301587, 0.5602387584, 128.9199840181],
    ["II.C-226", 0.3934771561, 0.4902364154, 130.3922423022],
    ["II.C-227", 0.5186642945, 0.4541901634, 178.6359517335],
    ["II.C-228", 0.3524931856, 0.4505770398, 110.5012506668],
    ["II.C-229", 0.3697593874, 0.5206204356, 138.5644185707],
    ["II.C-230", 0.1744019921, 0.5732931066, 119.3409051099],
    ["II.C-231", 0.2507324209, 0.5609900202, 132.5826540167],
    ["II.C-232", 0.3102568382, 0.3782456948, 98.4450118457],
    ["II.C-233", 0.3164477867, 0.3698035086, 100.1147034290],
    ["II.C-234", 0.5017058130, 0.3990265330, 164.4248192381],
    ["II.C-235", 0.4964835592, 0.4057747351, 164.5510136944],
    ["II.C-236", 0.4408929544, 0.4698230681, 167.8693941629],
    ["II.C-237", 0.2461487944, 0.6145395833, 178.2090341298],
    ["II.C-238", 0.4984243728, 0.3329687902, 148.3551137804],
    ["II.C-239", 0.3700247775, 0.5202555395, 164.0744043589],
    ["II.C-240", 0.0760602620, 0.5596439595, 124.7398513280],
    ["II.C-241", 0.2629848757, 0.5682829440, 157.2343331952],
    ["II.C-242", 0.4412121748, 0.4675245937, 173.2839445231],
    ["II.C-243", 0.2823167104, 0.3047669596, 93.9381222516],
    ["II.C-244", 0.4148849874, 0.4294385631, 152.4007166724],
    ["II.C-245", 0.2590526978, 0.5675456785, 161.7057059926],
    ["II.C-246", 0.4127173212, 0.4811313628, 172.7271237236],
    ["II.C-247", 0.2984774772, 0.3112529516, 99.9639866944],
    ["II.C-248", 0.4548792495, 0.0896454467, 108.4524334532],
    ["II.C-249", 0.2665841319, 0.3022483726, 102.1824317103],
    ["II.C-250", 0.4844029847, 0.3736255064, 177.3515504868],
    ["II.C-251", 0.3411937664, 0.3825680644, 131.0523112095],
    ["II.C-252", 0.0586366068, 0.5597110167, 142.9605350754],
    ["II.C-253", 0.3804169509, 0.4572231874, 169.3702787280],
    ["II.C-254", 0.5037923362, 0.1747438086, 143.5988884160],
    ["II.C-255", 0.2561269120, 0.5608155668, 180.1580642764],
    ["II.C-256", 0.2837482257, 0.5614963919, 189.9268027134],
    ["II.C-257", 0.5131588515, 0.2602604185, 168.5910027941],
    ["II.C-258", 0.4645822446, 0.1953706981, 147.6469709211],
    ["II.C-259", 0.2917230338, 0.3452541720, 130.3529990771],
    ["II.C-260", 0.3112891054, 0.2267370723, 121.6024452554],
    ["II.C-261", 0.2454949884, 0.2540955605, 117.1126560935],
    ["II.C-262", 0.0287862275, 0.5707533073, 181.4588447950],
    ["II.C-263", 0.2562136355, 0.2838084549, 125.6570100053],
    ["II.C-264", 0.4170034770, 0.3102262150, 168.4651914531],
    ["II.C-265", 0.3144776347, 0.3384505706, 147.5270266470],
    ["II.C-266", 0.4918473155, 0.2454925215, 187.4542190908],
    ["II.C-267", 0.3761809218, 0.3532059176, 170.5138193587],
    ["II.C-268", 0.3056392216, 0.1836258098, 129.2171362065],
    ["II.C-269", 0.4960977515, 0.2385446088, 197.8631582971],
    ["II.C-270", 0.4104114120, 0.3445688496, 192.5445595982],
    ["II.C-271", 0.2467372077, 0.2775100851, 136.6911306267],
    ["II.C-272", 0.4575453115, 0.1342591236, 170.7060517460],
    ["II.C-273", 0.4172215985, 0.2993562736, 192.1261448292],
    ["II.C-274", 0.2949718542, 0.1827156599, 140.1366752667],
    ["II.C-275", 0.2855835377, 0.2660169761, 149.6591730432],
    ["II.C-276", 0.3603318276, 0.2709274707, 177.5718855596],
    ["II.C-277", 0.2507351786, 0.2255040571, 149.0890582528],
    ["II.C-278", 0.3629372328, 0.3162617929, 195.3285969934],
    ["II.C-279", 0.3489312300, 0.1929567624, 167.8515325534],
    ["II.C-280", 0.3367192080, 0.2245212441, 169.5289089831],
    ["II.C-281", 0.3345518669, 0.2491328461, 173.2986495241],
    ["II.C-282", 0.2661161012, 0.2372575353, 161.3204581667],
    ["II.C-283", 0.3263451304, 0.2232000030, 173.6238700114],
    ["II.C-284", 0.2691801071, 0.2735720090, 174.8747847822],
    ["II.C-285", 0.3871025522, 0.0815328019, 180.8302707269],
    ["II.C-286", 0.3160793968, 0.2637288074, 185.5272060127],
    ["II.C-287", 0.2760184543, 0.3032382309, 185.9955024470],
    ["II.C-288", 0.2727528907, 0.2677183168, 181.1571379148],
    ["II.C-289", 0.2622757577, 0.2330074672, 172.7824864667],
    ["II.C-290", 0.3183530021, 0.1922865149, 180.2913171422],
    ["II.C-291", 0.3399550132, 0.1541144944, 180.7565986170],
    ["II.C-292", 0.3631773805, 0.0949879733, 181.4207291447],
    ["II.C-293", 0.3065816346, 0.2427199104, 185.8437676373],
    ["II.C-294", 0.3498808794, 0.1024629340, 184.8631924652],
    ["II.C-295", 0.2992239248, 0.2591926454, 194.1284833538],
    ["II.C-296", 0.3075000551, 0.2752303164, 199.8953995457],
    ["II.C-297", 0.3397933101, 0.1078662760, 189.0456502718],
    ["II.C-298", 0.2461251004, 0.2456980192, 191.0226619103],
    ["II.C-299", 0.2470038592, 0.2437055901, 197.1869561423],
    ["II.C-300", 0.3259384766, 0.1144879319, 198.6920179177],
  ];

  Object.assign(config.presets, buildLiLiaoPresets(liLiaoPresetRows));

  const state = {
    running: false,
    frame: 0,
    simTime: 0,
    G: 1.0,
    timeSpeed: 1.0,
    softening: config.defaultSoftening,
    fixedTimeStep: config.defaultFixedTimeStep,
    maxSubsteps: config.defaultMaxSubsteps,
    relTolerance: config.defaultRelTolerance,
    absTolerance: config.defaultAbsTolerance,
    accumulator: 0,
    lastTs: null,
    currentPreset: config.defaultPreset,
    defaultMasses: {},
    defaultPositions: {},
    view: {
      width: 0,
      height: 0,
      centerX: 0,
      centerY: 0,
      scale: 1,
      dpr: 1,
    },
    bodies: [],
    trailsCtx: null,
    drag: {
      active: false,
      pointerId: null,
      bodyId: null,
      wasRunning: false,
    },
  };

  const ui = {};

  function toPresetKeyFromCatalogId(catalogId) {
    return (
      "li-liao-" +
      String(catalogId)
        .toLowerCase()
        .replace(/[^a-z0-9]+/g, "-")
        .replace(/^-+|-+$/g, "")
    );
  }

  function buildLiLiaoPresets(rows) {
    const generated = {};
    rows.forEach(function (row) {
      const catalogId = row[0];
      const vx = row[1];
      const vy = row[2];
      const period = row[3];
      const key = toPresetKeyFromCatalogId(catalogId);
      if (!key || generated[key]) {
        return;
      }

      generated[key] = {
        label: catalogId + " (Li-Liao)",
        period: period,
        masses: { alpha: 1.0, beta: 1.0, gamma: 1.0 },
        positions: {
          alpha: { x: -1.0, y: 0.0 },
          beta: { x: 1.0, y: 0.0 },
          gamma: { x: 0.0, y: 0.0 },
        },
        velocities: {
          alpha: { x: vx, y: vy },
          beta: { x: vx, y: vy },
          gamma: { x: -2 * vx, y: -2 * vy },
        },
        G: 1.0,
        speed: 1.0,
      };
    });
    return generated;
  }

  function formatPresetLabel(key, preset) {
    if (preset && preset.label) {
      return preset.label;
    }

    return key
      .split("-")
      .filter(Boolean)
      .map(function (part) {
        return part.charAt(0).toUpperCase() + part.slice(1);
      })
      .join(" ");
  }

  function getPresetEntries() {
    const curatedRank = curatedPresetOrder.reduce(function (acc, key, index) {
      acc[key] = index;
      return acc;
    }, {});

    const entries = Object.keys(config.presets).map(function (key) {
      return {
        key: key,
        preset: config.presets[key],
        label: formatPresetLabel(key, config.presets[key]),
      };
    });

    entries.sort(function (a, b) {
      const aRank =
        Object.prototype.hasOwnProperty.call(curatedRank, a.key) ? curatedRank[a.key] : Infinity;
      const bRank =
        Object.prototype.hasOwnProperty.call(curatedRank, b.key) ? curatedRank[b.key] : Infinity;

      if (aRank !== bRank) {
        return aRank - bRank;
      }

      return a.label.localeCompare(b.label, undefined, {
        sensitivity: "base",
        numeric: true,
      });
    });

    return entries;
  }

  function populatePresetSelect() {
    const entries = getPresetEntries();
    ui.presetSelect.textContent = "";
    entries.forEach(function (entry) {
      const option = document.createElement("option");
      option.value = entry.key;
      option.textContent = entry.label;
      ui.presetSelect.appendChild(option);
    });
  }

  function byId(id) {
    const element = document.getElementById(id);
    if (!element) {
      throw new Error("Missing required element: #" + id);
    }
    return element;
  }

  function clamp(value, min, max) {
    return Math.min(max, Math.max(min, value));
  }

  function toNumber(value, fallback) {
    const parsed = Number(value);
    return Number.isFinite(parsed) ? parsed : fallback;
  }

  function formatVelocity(value) {
    return (value * config.displayUnitScale).toFixed(6).replace(/\.?0+$/, "") + " u/s";
  }

  function formatCoord(value) {
    return (value * config.displayUnitScale).toFixed(2);
  }

  function formatMass(value) {
    return "M: " + value.toFixed(2);
  }

  function formatTime(secondsOffset) {
    const daySeconds = 24 * 3600;
    const total =
      (((config.defaultClockSeconds + Math.floor(Math.max(0, secondsOffset))) % daySeconds) +
        daySeconds) %
      daySeconds;
    const hh = String(Math.floor(total / 3600)).padStart(2, "0");
    const mm = String(Math.floor((total % 3600) / 60)).padStart(2, "0");
    const ss = String(total % 60).padStart(2, "0");
    return "T: " + hh + ":" + mm + ":" + ss;
  }

  function formatG(value) {
    return value.toExponential(2);
  }

  function formatSpeed(value) {
    return "x" + value.toFixed(2);
  }

  function cloneVectorMap(source) {
    return Object.keys(source).reduce(function (acc, key) {
      acc[key] = { x: source[key].x, y: source[key].y };
      return acc;
    }, {});
  }

  function cloneMassMap(source) {
    return Object.keys(source).reduce(function (acc, key) {
      acc[key] = source[key];
      return acc;
    }, {});
  }

  function applyPresetNumerics() {
    state.softening = config.presetSoftening;
    state.fixedTimeStep = config.presetFixedTimeStep;
    state.maxSubsteps = config.presetMaxSubsteps;
    state.relTolerance = config.presetRelTolerance;
    state.absTolerance = config.presetAbsTolerance;
    if (ui.speedSlider) {
      ui.speedSlider.max = String(config.presetSpeedMax);
      if (toNumber(ui.speedSlider.value, 1) > config.presetSpeedMax) {
        ui.speedSlider.value = String(config.presetSpeedMax);
      }
    }
  }

  function captureElements() {
    ui.simView = byId("sim-view");
    ui.trailCanvas = byId("trail-canvas");
    ui.runButton = byId("run-btn");
    ui.resetButton = byId("reset-btn");
    ui.presetSelect = byId("preset-select");
    ui.gSlider = byId("g-slider");
    ui.speedSlider = byId("speed-slider");
    ui.gValue = byId("g-value");
    ui.speedValue = byId("speed-value");
    ui.frameValue = byId("frame-value");
    ui.modeValue = byId("mode-value");
    ui.simTime = byId("sim-time");

    ui.controls = {
      alpha: {
        body: byId("body-alpha"),
        label: byId("label-alpha"),
        massValue: byId("mass-alpha"),
        vxSlider: byId("vx-alpha"),
        vySlider: byId("vy-alpha"),
        vxValue: byId("vx-alpha-value"),
        vyValue: byId("vy-alpha-value"),
        trajectory: byId("traj-alpha"),
        status: byId("status-alpha"),
      },
      beta: {
        body: byId("body-beta"),
        label: byId("label-beta"),
        massValue: byId("mass-beta"),
        vxSlider: byId("vx-beta"),
        vySlider: byId("vy-beta"),
        vxValue: byId("vx-beta-value"),
        vyValue: byId("vy-beta-value"),
        trajectory: byId("traj-beta"),
        status: byId("status-beta"),
      },
      gamma: {
        body: byId("body-gamma"),
        label: byId("label-gamma"),
        massValue: byId("mass-gamma"),
        vxSlider: byId("vx-gamma"),
        vySlider: byId("vy-gamma"),
        vxValue: byId("vx-gamma-value"),
        vyValue: byId("vy-gamma-value"),
        trajectory: byId("traj-gamma"),
        status: byId("status-gamma"),
      },
    };

    state.trailsCtx = ui.trailCanvas.getContext("2d");
    if (!state.trailsCtx) {
      throw new Error("Could not create 2D context for trail canvas");
    }
  }

  function createBodies() {
    state.bodies = Object.keys(ui.controls).map(function (id) {
      const ctrl = ui.controls[id];
      return {
        id: id,
        name: id.toUpperCase(),
        mass: 1,
        x: 0,
        y: 0,
        vx: 0,
        vy: 0,
        ax: 0,
        ay: 0,
        skipTrail: false,
        control: ctrl,
      };
    });
  }

  function getBodyById(id) {
    return state.bodies.find(function (candidate) {
      return candidate.id === id;
    });
  }

  function setVelocitySliders(id, vx, vy) {
    const control = ui.controls[id];
    const scale = config.displayUnitScale;
    control.vxSlider.value = clamp(
      vx * scale,
      toNumber(control.vxSlider.min, -60),
      toNumber(control.vxSlider.max, 60)
    ).toFixed(6);
    control.vySlider.value = clamp(
      vy * scale,
      toNumber(control.vySlider.min, -60),
      toNumber(control.vySlider.max, 60)
    ).toFixed(6);
  }

  function updateBodyVelocityFromSliders(id) {
    const body = getBodyById(id);
    if (!body) {
      return;
    }

    const vxSlider = body.control.vxSlider;
    const vySlider = body.control.vySlider;
    const scale = config.displayUnitScale;
    const vxMin = toNumber(vxSlider.min, -60);
    const vxMax = toNumber(vxSlider.max, 60);
    const vyMin = toNumber(vySlider.min, -60);
    const vyMax = toNumber(vySlider.max, 60);

    const vxDisplay = clamp(toNumber(vxSlider.value, body.vx * scale), vxMin, vxMax);
    const vyDisplay = clamp(toNumber(vySlider.value, body.vy * scale), vyMin, vyMax);

    body.vx = vxDisplay / scale;
    body.vy = vyDisplay / scale;

    body.control.vxValue.textContent = formatVelocity(body.vx);
    body.control.vyValue.textContent = formatVelocity(body.vy);
  }

  function readControlsIntoState() {
    const speedMax = toNumber(ui.speedSlider.max, config.defaultSpeedMax);
    state.G = clamp(toNumber(ui.gSlider.value, state.G), 0.1, 3.0);
    state.timeSpeed = clamp(toNumber(ui.speedSlider.value, state.timeSpeed), 0.1, speedMax);
    ui.gValue.textContent = formatG(state.G);
    ui.speedValue.textContent = formatSpeed(state.timeSpeed);
  }

  function bindControls() {
    Object.keys(ui.controls).forEach(function (id) {
      const control = ui.controls[id];
      control.vxSlider.addEventListener("input", function () {
        updateBodyVelocityFromSliders(id);
        updateLabelsAndStats();
      });
      control.vySlider.addEventListener("input", function () {
        updateBodyVelocityFromSliders(id);
        updateLabelsAndStats();
      });

      control.body.addEventListener("pointerdown", function (event) {
        onBodyPointerDown(id, event);
      });
    });

    ui.presetSelect.addEventListener("change", function () {
      applyPreset(ui.presetSelect.value);
    });

    ui.gSlider.addEventListener("input", function () {
      readControlsIntoState();
      updateLabelsAndStats();
    });

    ui.speedSlider.addEventListener("input", function () {
      readControlsIntoState();
      updateLabelsAndStats();
    });

    ui.runButton.addEventListener("click", toggleRun);
    ui.resetButton.addEventListener("click", resetSimulation);
    window.addEventListener("resize", handleResize);
    window.addEventListener("pointermove", onGlobalPointerMove);
    window.addEventListener("pointerup", onGlobalPointerUpOrCancel);
    window.addEventListener("pointercancel", onGlobalPointerUpOrCancel);
  }

  function handleResize() {
    const rect = ui.simView.getBoundingClientRect();
    if (!rect.width || !rect.height) {
      return;
    }

    state.view.width = rect.width;
    state.view.height = rect.height;
    state.view.centerX = rect.width / 2;
    state.view.centerY = rect.height / 2;
    state.view.scale = Math.min(rect.width, rect.height) * config.worldScaleFactor;
    state.view.dpr = window.devicePixelRatio || 1;

    ui.trailCanvas.width = Math.max(1, Math.floor(rect.width * state.view.dpr));
    ui.trailCanvas.height = Math.max(1, Math.floor(rect.height * state.view.dpr));
    ui.trailCanvas.style.width = rect.width + "px";
    ui.trailCanvas.style.height = rect.height + "px";

    state.trailsCtx.setTransform(state.view.dpr, 0, 0, state.view.dpr, 0, 0);
    state.trailsCtx.lineCap = "round";
    state.trailsCtx.lineJoin = "round";

    clearTrails();
    renderBodies();
  }

  function clearTrails() {
    const ctx = state.trailsCtx;
    ctx.save();
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.clearRect(0, 0, ui.trailCanvas.width, ui.trailCanvas.height);
    ctx.restore();
  }

  function worldToScreen(x, y) {
    return {
      x: state.view.centerX + x * state.view.scale,
      y: state.view.centerY - y * state.view.scale,
    };
  }

  function screenToWorld(clientX, clientY) {
    const rect = ui.simView.getBoundingClientRect();
    const localX = clientX - rect.left;
    const localY = clientY - rect.top;
    return {
      x: (localX - state.view.centerX) / state.view.scale,
      y: (state.view.centerY - localY) / state.view.scale,
    };
  }

  function moveBodyToPointer(body, event) {
    const world = screenToWorld(event.clientX, event.clientY);
    body.x = world.x;
    body.y = world.y;
    body.skipTrail = true;
    computeAccelerations(state.bodies, state.G, state.softening);
    renderBodies();
    updateLabelsAndStats();
  }

  function startDragging(id, event) {
    if (state.drag.active) {
      stopDragging(false);
    }

    const body = getBodyById(id);
    if (!body) {
      return;
    }

    state.drag.active = true;
    state.drag.pointerId = event.pointerId;
    state.drag.bodyId = id;
    state.drag.wasRunning = state.running;

    state.running = false;
    state.accumulator = 0;
    state.lastTs = null;
    setRunButtonLabel();

    body.control.body.classList.add("is-dragging");
    if (body.control.body.setPointerCapture) {
      body.control.body.setPointerCapture(event.pointerId);
    }

    moveBodyToPointer(body, event);
  }

  function stopDragging(restoreRunState) {
    if (!state.drag.active) {
      return;
    }

    const body = getBodyById(state.drag.bodyId);
    const shouldResume = restoreRunState && state.drag.wasRunning;

    if (body) {
      body.control.body.classList.remove("is-dragging");
      if (
        state.drag.pointerId !== null &&
        body.control.body.releasePointerCapture &&
        body.control.body.hasPointerCapture &&
        body.control.body.hasPointerCapture(state.drag.pointerId)
      ) {
        body.control.body.releasePointerCapture(state.drag.pointerId);
      }
    }

    state.drag.active = false;
    state.drag.pointerId = null;
    state.drag.bodyId = null;
    state.drag.wasRunning = false;

    computeAccelerations(state.bodies, state.G, state.softening);

    if (shouldResume) {
      state.running = true;
      state.lastTs = null;
    }

    setRunButtonLabel();
  }

  function onBodyPointerDown(id, event) {
    if (event.pointerType === "mouse" && event.button !== 0) {
      return;
    }
    event.preventDefault();
    startDragging(id, event);
  }

  function onGlobalPointerMove(event) {
    if (!state.drag.active || event.pointerId !== state.drag.pointerId) {
      return;
    }
    const body = getBodyById(state.drag.bodyId);
    if (!body) {
      return;
    }
    event.preventDefault();
    moveBodyToPointer(body, event);
  }

  function onGlobalPointerUpOrCancel(event) {
    if (!state.drag.active || event.pointerId !== state.drag.pointerId) {
      return;
    }
    stopDragging(true);
  }

  function drawTrailSegment(body, from, to) {
    const ctx = state.trailsCtx;
    ctx.beginPath();
    ctx.globalAlpha = 0.35;
    ctx.strokeStyle = config.colors[body.id];
    ctx.lineWidth = 1.2;
    ctx.moveTo(from.x, from.y);
    ctx.lineTo(to.x, to.y);
    ctx.stroke();
    ctx.globalAlpha = 1;
  }

  function computeAccelerations(bodies, G, softening) {
    const effectiveSoftening = Math.max(softening, 0);

    bodies.forEach(function (body) {
      body.ax = 0;
      body.ay = 0;
    });

    for (let i = 0; i < bodies.length; i += 1) {
      for (let j = i + 1; j < bodies.length; j += 1) {
        const bi = bodies[i];
        const bj = bodies[j];
        const dx = bj.x - bi.x;
        const dy = bj.y - bi.y;
        const distanceSquared =
          dx * dx + dy * dy + effectiveSoftening * effectiveSoftening;
        const safeDistanceSquared = Math.max(distanceSquared, config.singularityEpsilon);
        const inverseDistance = 1 / Math.sqrt(safeDistanceSquared);
        const inverseDistanceCubed = inverseDistance * inverseDistance * inverseDistance;

        const aiFactor = G * bj.mass * inverseDistanceCubed;
        const ajFactor = G * bi.mass * inverseDistanceCubed;

        bi.ax += dx * aiFactor;
        bi.ay += dy * aiFactor;
        bj.ax -= dx * ajFactor;
        bj.ay -= dy * ajFactor;
      }
    }
  }

  function captureSnapshot() {
    return {
      x: state.bodies.map(function (body) {
        return body.x;
      }),
      y: state.bodies.map(function (body) {
        return body.y;
      }),
      vx: state.bodies.map(function (body) {
        return body.vx;
      }),
      vy: state.bodies.map(function (body) {
        return body.vy;
      }),
      mass: state.bodies.map(function (body) {
        return body.mass;
      }),
    };
  }

  function applySnapshot(snapshot) {
    state.bodies.forEach(function (body, index) {
      body.x = snapshot.x[index];
      body.y = snapshot.y[index];
      body.vx = snapshot.vx[index];
      body.vy = snapshot.vy[index];
    });
  }

  function computeAccelerationsForSnapshot(snapshot, G, softening) {
    const n = snapshot.x.length;
    const effectiveSoftening = Math.max(softening, 0);
    const ax = new Array(n).fill(0);
    const ay = new Array(n).fill(0);

    for (let i = 0; i < n; i += 1) {
      for (let j = i + 1; j < n; j += 1) {
        const dx = snapshot.x[j] - snapshot.x[i];
        const dy = snapshot.y[j] - snapshot.y[i];
        const distanceSquared = dx * dx + dy * dy + effectiveSoftening * effectiveSoftening;
        const safeDistanceSquared = Math.max(distanceSquared, config.singularityEpsilon);
        const inverseDistance = 1 / Math.sqrt(safeDistanceSquared);
        const inverseDistanceCubed = inverseDistance * inverseDistance * inverseDistance;

        const aiFactor = G * snapshot.mass[j] * inverseDistanceCubed;
        const ajFactor = G * snapshot.mass[i] * inverseDistanceCubed;

        ax[i] += dx * aiFactor;
        ay[i] += dy * aiFactor;
        ax[j] -= dx * ajFactor;
        ay[j] -= dy * ajFactor;
      }
    }

    return { ax: ax, ay: ay };
  }

  function derivativesForSnapshot(snapshot) {
    const acc = computeAccelerationsForSnapshot(snapshot, state.G, state.softening);
    return {
      dx: snapshot.vx.slice(),
      dy: snapshot.vy.slice(),
      dvx: acc.ax,
      dvy: acc.ay,
    };
  }

  function addScaledSnapshot(base, derivative, scale) {
    const n = base.x.length;
    const next = {
      x: new Array(n),
      y: new Array(n),
      vx: new Array(n),
      vy: new Array(n),
      mass: base.mass,
    };

    for (let i = 0; i < n; i += 1) {
      next.x[i] = base.x[i] + derivative.dx[i] * scale;
      next.y[i] = base.y[i] + derivative.dy[i] * scale;
      next.vx[i] = base.vx[i] + derivative.dvx[i] * scale;
      next.vy[i] = base.vy[i] + derivative.dvy[i] * scale;
    }

    return next;
  }

  function rk4AdvanceSnapshot(snapshot, dt) {
    const n = snapshot.x.length;
    const k1 = derivativesForSnapshot(snapshot);
    const k2 = derivativesForSnapshot(addScaledSnapshot(snapshot, k1, dt * 0.5));
    const k3 = derivativesForSnapshot(addScaledSnapshot(snapshot, k2, dt * 0.5));
    const k4 = derivativesForSnapshot(addScaledSnapshot(snapshot, k3, dt));

    const next = {
      x: new Array(n),
      y: new Array(n),
      vx: new Array(n),
      vy: new Array(n),
      mass: snapshot.mass,
    };

    const weight = dt / 6;
    for (let i = 0; i < n; i += 1) {
      next.x[i] =
        snapshot.x[i] + weight * (k1.dx[i] + 2 * k2.dx[i] + 2 * k3.dx[i] + k4.dx[i]);
      next.y[i] =
        snapshot.y[i] + weight * (k1.dy[i] + 2 * k2.dy[i] + 2 * k3.dy[i] + k4.dy[i]);
      next.vx[i] =
        snapshot.vx[i] +
        weight * (k1.dvx[i] + 2 * k2.dvx[i] + 2 * k3.dvx[i] + k4.dvx[i]);
      next.vy[i] =
        snapshot.vy[i] +
        weight * (k1.dvy[i] + 2 * k2.dvy[i] + 2 * k3.dvy[i] + k4.dvy[i]);
    }

    return next;
  }

  function estimateRkErrorRatio(fullStep, twoHalfSteps) {
    const n = fullStep.x.length;
    let maxRatio = 0;

    function accumulateRatio(fullValue, refinedValue) {
      const scale =
        state.absTolerance +
        state.relTolerance * Math.max(Math.abs(fullValue), Math.abs(refinedValue));
      const ratio = Math.abs(refinedValue - fullValue) / Math.max(scale, 1e-16);
      if (ratio > maxRatio) {
        maxRatio = ratio;
      }
    }

    for (let i = 0; i < n; i += 1) {
      accumulateRatio(fullStep.x[i], twoHalfSteps.x[i]);
      accumulateRatio(fullStep.y[i], twoHalfSteps.y[i]);
      accumulateRatio(fullStep.vx[i], twoHalfSteps.vx[i]);
      accumulateRatio(fullStep.vy[i], twoHalfSteps.vy[i]);
    }
    return maxRatio;
  }

  function drawTrailSegmentsFromSnapshots(previousSnapshot, nextSnapshot) {
    state.bodies.forEach(function (body, index) {
      const from = worldToScreen(previousSnapshot.x[index], previousSnapshot.y[index]);
      const to = worldToScreen(nextSnapshot.x[index], nextSnapshot.y[index]);
      const segmentLength = Math.hypot(to.x - from.x, to.y - from.y);

      if (body.skipTrail || segmentLength > config.maxTrailSegmentPx) {
        body.skipTrail = false;
      } else {
        drawTrailSegment(body, from, to);
      }
    });
  }

  function step(dt) {
    let remaining = dt;
    let acceptedSubsteps = 0;
    let attempts = 0;
    let h = Math.min(state.fixedTimeStep, remaining);
    let snapshot = captureSnapshot();

    while (
      remaining > 1e-12 &&
      acceptedSubsteps < state.maxSubsteps &&
      attempts < state.maxSubsteps * 8
    ) {
      attempts += 1;
      h = Math.min(h, remaining);
      h = Math.max(h, config.rkMinStep);

      const fullStep = rk4AdvanceSnapshot(snapshot, h);
      const halfStep = rk4AdvanceSnapshot(snapshot, h * 0.5);
      const twoHalfSteps = rk4AdvanceSnapshot(halfStep, h * 0.5);

      const rawErrorRatio = estimateRkErrorRatio(fullStep, twoHalfSteps);
      const errorRatio = Number.isFinite(rawErrorRatio) ? rawErrorRatio : Number.POSITIVE_INFINITY;
      const accepted = errorRatio <= 1 || h <= config.rkMinStep * 1.001;

      if (accepted) {
        drawTrailSegmentsFromSnapshots(snapshot, twoHalfSteps);
        snapshot = twoHalfSteps;
        remaining -= h;
        state.simTime += h;
        acceptedSubsteps += 1;

        if (errorRatio > 0) {
          const factor = 0.9 * Math.pow(1 / errorRatio, 0.2);
          h *= clamp(factor, config.rkShrinkLimit, config.rkGrowLimit);
        } else {
          h *= config.rkGrowLimit;
        }
        h = Math.min(h, state.fixedTimeStep);
      } else {
        const shrink =
          errorRatio === Number.POSITIVE_INFINITY
            ? config.rkShrinkLimit
            : 0.9 * Math.pow(1 / errorRatio, 0.25);
        h *= clamp(shrink, config.rkShrinkLimit, 1);
      }
    }

    if (remaining > 1e-12) {
      const finalStep = rk4AdvanceSnapshot(snapshot, remaining);
      drawTrailSegmentsFromSnapshots(snapshot, finalStep);
      snapshot = finalStep;
      state.simTime += remaining;
    }

    applySnapshot(snapshot);
    computeAccelerations(state.bodies, state.G, state.softening);

    state.frame += 1;
  }

  function renderBodies() {
    state.bodies.forEach(function (body) {
      const screen = worldToScreen(body.x, body.y);
      body.control.body.style.left = screen.x + "px";
      body.control.body.style.top = screen.y + "px";
    });
  }

  function updateTrajectoryAndStatus() {
    const totalMass = state.bodies.reduce(function (sum, body) {
      return sum + body.mass;
    }, 0);

    const centerOfMass = state.bodies.reduce(
      function (acc, body) {
        acc.x += body.mass * body.x;
        acc.y += body.mass * body.y;
        acc.vx += body.mass * body.vx;
        acc.vy += body.mass * body.vy;
        return acc;
      },
      { x: 0, y: 0, vx: 0, vy: 0 }
    );

    centerOfMass.x /= totalMass;
    centerOfMass.y /= totalMass;
    centerOfMass.vx /= totalMass;
    centerOfMass.vy /= totalMass;

    state.bodies.forEach(function (body) {
      const dx = body.x - centerOfMass.x;
      const dy = body.y - centerOfMass.y;
      const dvx = body.vx - centerOfMass.vx;
      const dvy = body.vy - centerOfMass.vy;
      const distance = Math.hypot(dx, dy);
      const speedSquared = dvx * dvx + dvy * dvy;
      const specificEnergy = 0.5 * speedSquared - (state.G * totalMass) / (distance + 1e-6);
      const radialSpeed = (dx * dvx + dy * dvy) / (distance + 1e-6);

      let trajectory = "UNSTABLE";
      if (specificEnergy < -0.03) {
        trajectory = "ELLIPTICAL";
      } else if (specificEnergy > 0.03) {
        trajectory = "HYPERBOLIC";
      }

      let status = "DECAYING";
      if (
        distance > config.ejectedDistance ||
        (trajectory === "HYPERBOLIC" && radialSpeed > 0.15 && distance > 6)
      ) {
        status = "EJECTED";
      } else if (trajectory === "ELLIPTICAL" && Math.abs(radialSpeed) < 0.3) {
        status = "STABLE";
      }

      body.control.trajectory.textContent = trajectory;
      body.control.status.textContent = status;
    });
  }

  function updateLabelsAndStats() {
    state.bodies.forEach(function (body) {
      body.control.label.textContent =
        body.name +
        " [X:" +
        formatCoord(body.x) +
        " Y:" +
        formatCoord(body.y) +
        "]";
    });

    ui.simTime.textContent = formatTime(state.simTime);
    ui.frameValue.textContent = "Frame: " + state.frame;
    ui.modeValue.textContent = "MODE: 2D N-BODY RK4";
    ui.gValue.textContent = formatG(state.G);
    ui.speedValue.textContent = formatSpeed(state.timeSpeed);

    updateTrajectoryAndStatus();
  }

  function applyPreset(presetKey) {
    const preset = config.presets[presetKey];
    if (!preset) {
      return;
    }

    stopDragging(false);
    state.running = false;
    state.frame = 0;
    state.simTime = 0;
    state.accumulator = 0;
    state.lastTs = null;
    state.currentPreset = presetKey;
    state.defaultMasses = cloneMassMap(preset.masses);
    state.defaultPositions = cloneVectorMap(preset.positions);
    applyPresetNumerics();

    ui.presetSelect.value = presetKey;
    ui.gSlider.value = String(preset.G);
    ui.speedSlider.value = String(preset.speed);

    state.bodies.forEach(function (body) {
      const mass = state.defaultMasses[body.id];
      const position = state.defaultPositions[body.id];
      const velocity = preset.velocities[body.id];

      body.mass = mass;
      body.x = position.x;
      body.y = position.y;
      body.ax = 0;
      body.ay = 0;
      body.skipTrail = true;
      body.control.massValue.textContent = formatMass(mass);

      setVelocitySliders(body.id, velocity.x, velocity.y);
      updateBodyVelocityFromSliders(body.id);
    });

    readControlsIntoState();
    computeAccelerations(state.bodies, state.G, state.softening);
    clearTrails();
    renderBodies();
    updateLabelsAndStats();
    setRunButtonLabel();
  }

  function setRunButtonLabel() {
    ui.runButton.textContent = state.running ? "Pause" : "Run Simulation";
  }

  function resetSimulation() {
    stopDragging(false);
    state.running = false;
    state.frame = 0;
    state.simTime = 0;
    state.accumulator = 0;
    state.lastTs = null;

    if (!state.defaultPositions.alpha || !state.defaultMasses.alpha) {
      applyPreset(config.defaultPreset);
      return;
    }

    readControlsIntoState();

    state.bodies.forEach(function (body) {
      const defaults = state.defaultPositions[body.id];
      body.x = defaults.x;
      body.y = defaults.y;
      body.mass = state.defaultMasses[body.id];
      body.control.massValue.textContent = formatMass(body.mass);
      updateBodyVelocityFromSliders(body.id);
      body.ax = 0;
      body.ay = 0;
      body.skipTrail = true;
    });

    computeAccelerations(state.bodies, state.G, state.softening);
    clearTrails();
    renderBodies();
    updateLabelsAndStats();
    setRunButtonLabel();
  }

  function toggleRun() {
    if (state.drag.active) {
      return;
    }
    state.running = !state.running;
    state.accumulator = 0;
    state.lastTs = null;
    setRunButtonLabel();
  }

  function getRandomPresetKey() {
    const presetKeys = Object.keys(config.presets);
    if (!presetKeys.length) {
      return config.defaultPreset;
    }
    const randomIndex = Math.floor(Math.random() * presetKeys.length);
    return presetKeys[randomIndex];
  }

  function tick(timestamp) {
    if (state.lastTs === null) {
      state.lastTs = timestamp;
    }

    const elapsedSeconds = Math.min((timestamp - state.lastTs) / 1000, 0.25);
    state.lastTs = timestamp;

    if (state.running) {
      state.accumulator += elapsedSeconds * state.timeSpeed;

      let substeps = 0;
      while (state.accumulator >= state.fixedTimeStep && substeps < state.maxSubsteps) {
        step(state.fixedTimeStep);
        state.accumulator -= state.fixedTimeStep;
        substeps += 1;
      }

      if (substeps === state.maxSubsteps) {
        state.accumulator = Math.min(state.accumulator, state.fixedTimeStep * 4);
      }

      renderBodies();
      updateLabelsAndStats();
    }

    requestAnimationFrame(tick);
  }

  function init() {
    captureElements();
    createBodies();
    populatePresetSelect();
    bindControls();
    handleResize();
    applyPreset(getRandomPresetKey());
    state.running = true;
    state.accumulator = 0;
    state.lastTs = null;
    setRunButtonLabel();
    requestAnimationFrame(tick);
  }

  init();
})();
